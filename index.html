<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>Capital: System and Suffering</title>
		<link rel='stylesheet' href='libraries/tachyons.css' />
		<link rel='stylesheet' href='libraries/font-awesome.css' />
		<link rel='stylesheet' href='resources/capital.css' />
	</head>
	<body>
		<main id='society' class='pv4 ph5 center'>
			<h1 class='mb0'><i>Capital</i></h1>
			<div class='mb3'>
				<a class='dib fr no-underline gray' href='https://github.com/janbaykara/capital'>project repository <span class='fa fa-github'></span> </a>
				<span class='b'>Day {{day}}&nbsp;</span>
				<span class='pointer fa' v-on:click='clockTicking ? clockPause() : clockStart()' v-bind:class="{'fa-pause': clockTicking, 'fa-play': !clockTicking}"></span>
				<span>&nbsp;Clock speed/day:</span>
				<span class='gray'>
					<span class='speedOption pointer' v-bind:class="{black: ms == tickSpeed}" v-for='ms in speedOptions' v-on:click="changeTickSpeed(ms)">{{ms/1000}}s&nbsp;</span>
				</span>
			</div>

			<a v-on:click='graphs = !graphs' class='dib pointer pa2 ba black-70 b'>{{graphs ? "Hide graphs" : "Show graphs"}}</a>
			<a v-on:click='wholegraph = !wholegraph' class='dib pointer pa2 ba black-70 b'>{{wholegraph ? "Last 30 days" : "All-time data" }}</a>

			<br class='cf'>
			<div v-if='graphs'>
				<div class='fl w-third mv3 pr2'>
					<div>
						<div class='f4 b'>Commodities</div>
						<div class='f5'>{{current(statistics.commodityStock)|d(0)}} surplus</div>
						<div class='f5'>Avg of {{current(statistics.commodityStock)/current(statistics.currentPopulation)|d(0)}} commodities per person</div>
						<area-chart :wholegraph='wholegraph' class='mt1 ' :stats='statistics.commodityStock.values' :ceil='statistics.commodityStock.ceiling' style='width: 100%; height: 150px;'></area-chart>
					</div>
					<div class='bt b--light-gray mv2'></div>
					<div>
						<div class='f4 b'>Commodity price</div>
						<div class='f5'>{{current(statistics.commodityPrice)|v}} (Labour Time Socially Necessary)</div>
						<area-chart :wholegraph='wholegraph' class='mt1 ' :stats='statistics.commodityPrice.values' :ceil='statistics.commodityPrice.ceiling' :floor='statistics.commodityPrice.floor' style='width: 100%; height: 150px;'></area-chart>
					</div>
				</div>

				<div class='fl w-third mv3 twocharts bl br ph2 b--light-gray'>
					<div class='f4 b'>Production &amp; Consumption</div>
					<div class='f5'>{{current(statistics.dailyProductTotal)|d(0)}} daily production ({{current(statistics.dailyProductTotal)/current(statistics.dailyFoodNeeded)|%(1)}} of required)</div>
					<div class='f5'>{{current(statistics.dailyProductAvg)|d(1)}} avg daily production per person</div>
					<div class='mv1 chartContrast relative' style='width: 100%; height: 321px;'>
						<area-chart :wholegraph='wholegraph' class='absolute ' :stats='statistics.dailyProductTotal.values' :ceil='statistics.dailyProductTotal.ceiling' style='width: 100%; height: 321px;'></area-chart>
						<area-chart :wholegraph='wholegraph' class='absolute ' :stats='statistics.dailyFoodNeeded.values' :ceil='statistics.dailyProductTotal.ceiling' style='width: 100%; height: 321px;'></area-chart>
					</div>
					<div class='f5'>{{current(statistics.dailyFoodNeeded)|d(0)}} daily required ({{current(statistics.dailyFoodNeeded)/current(statistics.dailyProductTotal)|%(1)}} of capacity)</div>
					<div class='f5'>{{current(statistics.dailyHunger)|d(0)}} outstanding hunger ({{current(statistics.averageHunger)|d(1)}}% avg)</div>
				</div>

				<div class='fl w-third mv3 pl2'>
					<div>
						<div class='f4 b'>{{current(statistics.currentPopulation)}} humans</div>
						<div class='f5' v-if='lifecycle'>Average age {{current(statistics.averageAge)|d(0)}}, {{current(statistics.averageOffspring)|d(2)}} kids per person</div>
						<div class='mv1 chartSubcategories relative' style='width: 100%; height: 150px;'>
							<area-chart :wholegraph='wholegraph' class=' absolute' :stats='statistics.currentPopulation.values' :ceil='statistics.currentPopulation.ceiling' style='width: 100%; height: 150px;'></area-chart>
							<area-chart :wholegraph='wholegraph' class=' absolute' :stats='statistics.workingPopulation.values' :ceil='statistics.currentPopulation.ceiling' style='width: 100%; height: 150px;'></area-chart>
						</div>
						<div class='f5' v-if='lifecycle'>{{current(statistics.workingPopulation)/current(statistics.currentPopulation)|%(0)}} working population</div>
					</div>
					<div class='bt b--light-gray mv2'></div>
					<div>
						<div class='f4 b'>Avg Productivity</div>
						<div class='f5'>{{current(statistics.productivityAvg)|d(2)}} commodities/hr</div>
						<area-chart :wholegraph='wholegraph' class='mt1 ' :stats='statistics.productivityAvg.values' :ceil='statistics.productivityAvg.ceiling' :floor='statistics.productivityAvg.floor' style='width: 100%; height: 150px;'></area-chart>
					</div>
				</div>
			</div>
		</main>

		<template id='area-chart'>
			<div class='area-chart'>
				<svg :width="width" :height="height">
					<g :style="{transform: 'translate(${margin.left}px, ${margin.top}px)'}">
						<path class="area" :d="paths.area" style='fill: ${fill}'/>
						<path class="line" :d="paths.line" style='stroke: ${stroke}'/>
						<path class="selector" :d="paths.selector" />
					</g>
				</svg>
			</div>
		</template>

		<script src='resources/jquery.js'></script>
		<script src='resources/lodash.js'></script>
		<script src='resources/d3.js'></script>
		<script src='resources/vue.js'></script>
		<script src='resources/capital_graph.js'></script>
		<script src='resources/capital_ui.js'></script>
		<!-- <script src='resources/capital_helpers.js'></script>
		<script src='resources/capital_human.js'></script>
		<script src='resources/capital_society.js'></script>
		<script src='resources/capital.js'></script> -->
	</body>
</html>
