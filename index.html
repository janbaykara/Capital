<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>Capital: System and Suffering</title>
		<link rel='stylesheet' href='libraries/tachyons.css' />
		<link rel='stylesheet' href='libraries/font-awesome.css' />
		<link rel='stylesheet' href='resources/capital.css' />
	</head>
	<body>
		<main id='society' class='pv4 ph5 center'>
			<h1 class='mb0'><i>Capital</i></h1>
			<div>
				<a class='dib fr no-underline gray' href='https://github.com/janbaykara/capital'>project repository <span class='fa fa-github'></span> </a>
				<span class='b'>Day {{day}}&nbsp;</span>
				<span class='pointer fa' v-on:click='clockTicking ? clockPause() : clockStart()' v-bind:class="{'fa-pause': clockTicking, 'fa-play': !clockTicking}"></span>
				<span>&nbsp;Clock speed/day:</span>
				<span class='gray'>
					<span class='speedOption pointer' v-bind:class="{black: ms == tickSpeed}" v-for='ms in speedOptions' v-on:click="changeTickSpeed(ms)">{{ms/1000}}s&nbsp;</span>
				</span>
			</div>
			<div class='f3 mv3' v-if='savings'>{{averageWealth|£}} average wealth accumulated</div>
			<div style='display: none;'>{{dailyFoodNeeded}}</div>
			<!-- For the weirdest reason, the graphds don't display if dailyFoodNeeded isn't rendered above this line. -->

			<!-- D3 charts for: -->
			<!-- * population growth -->
			<!-- * Life expectancy -->
			<!-- * Life expectancy by wealth at death -->
			<!-- * GDP growth -->
			<!-- * GDP per capita -->
			<!-- * Avg personal wealth -->
			<!-- * Wealth by age -->
			<!-- * Wealth by skill -->
			<!-- * Wealth by hunger -->
			<!-- * Productivity growth -->
			<!-- * GINI coefficient -->

			<div class='fl w-33 mv3'>
				<div class='f4 b'>{{currentPopulation.length}} humans</div>
				<div class='f5' v-if='lifecycle'>Average age {{averageAge|d(0)}}, {{averageOffspring|d(2)}} kids per person</div>
				<area-chart :stats='statistics.currentPopulation' :ceil='statSets.currentPopulation.ceiling' class='ba b--gray' style='width: 300px; height: 150px;'>
				</area-chart>
			</div>

			<div class='fl w-33 mv3'>
				<div class='f4 b'>Socially Necessary Labour-Time</div>
				<div class='f5'>{{LabourTimeSocNec|£}}</div>
				<area-chart :stats='statistics.LabourTimeSocNec' :ceil='statSets.LabourTimeSocNec.ceiling' :floor='statSets.LabourTimeSocNec.floor' class='ba b--gray' style='width: 300px; height: 150px;'>
				</area-chart>
			</div>

			<div class='fl w-33 mv3'>
				<div class='f4 b'>Average Hours Worked</div>
				<div class='f5'>{{averageWorkingDay|hrs}}</div>
				<area-chart :stats='statistics.averageWorkingDay' :ceil='statSets.averageWorkingDay.ceiling' :floor='statSets.averageWorkingDay.floor' class='ba b--gray' style='width: 300px; height: 150px;'>
				</area-chart>
			</div>

			<div class='fl w-33 mv3'>
				<div class='f4 b'>Stock of commodities</div>
				<div class='f5'>{{commodityStock|d(0)}}</div>
				<area-chart :stats='statistics.commodityStock' :ceil='statSets.commodityStock.ceiling' class='ba b--gray' style='width: 300px; height: 150px;'>
				</area-chart>
			</div>

			<div class='fl w-33 mv3'>
				<div class='f4 b'>Daily Production</div>
				<div class='f5'>{{dailyProductTotal|d(1)}} daily production ({{dailyProductTotal/dailyFoodNeeded|%(1)}} of required)</div>
				<div class='f5'>{{dailyProductAvg|d(1)}} avg daily production per person</div>
				<area-chart :stats='statistics.dailyProductTotal' :ceil='statSets.dailyProductTotal.ceiling' class='ba b--gray' style='width: 300px; height: 150px;'>
				</area-chart>
			</div>

			<div class='fl w-33 mv3'>
				<div class='f4 b'>Daily Consumption</div>
				<div class='f5'>{{dailyFoodNeeded}} daily required ({{dailyFoodNeeded/dailyProductTotal|%(1)}} of capacity)</div>
				<div class='f5'>{{dailyHunger|d(1)}} outstanding hunger ({{averageHunger|%(1)}} avg)</div>
				<area-chart :stats='statistics.dailyFoodNeeded' :ceil='statSets.dailyProductTotal.ceiling' class='ba b--gray' style='width: 300px; height: 150px;'>
				</area-chart>
			</div>

			<br class='cf'>
			<br>
			<table class='population f6' cellpadding="0" cellspacing="0">
				<tr v-for="person in currentPopulation"
					v-on:click="person.isHighlighted = !person.isHighlighted"
					v-bind:class="{ highlighted: person.isHighlighted, hungry: person.hunger > 0.01, lazy: person.LabourIndividualProductivity < LabourTimeSocNec, poor: person.savings < 0.01, young: person.age < person.ageAdult, old: person.age >= person.ageElderly, overworked: person.hoursWorked == person.hoursInDay, dead: !person.alive }">
					<td class='pr1 tr code'>{{person.DNA}}</td>
					<td class='ph1 tr name'>{{person.firstname}} <b>{{person.lastname}}</b></td>
					<td class='ph1 age' v-if="lifecycle" >(Gen {{person.generation}}, aged <b>{{person.age}}</b>)</td>
					<td class='ph1'>(<b>{{person.LabourIndividualProductivity|d(3)}}</b> productivity,</td>
					<td class='ph1 tr LabourIndividualProductivity'><b>{{person.hourlyRelativeProduct|d(2)}}</b> × avg)</td>
					<td class='ph1 hoursWorked'>works <b>{{person.hoursWorked|hrs}} hrs</b></td>
					<td class='ph1 tr'>and produces <b>{{person.dailyProduct|d(1)}}</b></td>
					<td class='ph1 tr'>for <b>{{person.hourlyRelativeProduct * person.hoursWorked|£}}</b> daily</td>
					<td class='ph1 b'>&middot;</td>
					<td class='ph1 tr savings' v-if='savings'>Savings: <b>{{person.savings|£}}</b></td>
					<td class='pl1 tr hunger'>(<b>{{person.hunger|%(0)}} hungry</b>)</td>
				</tr>
			</table>
		</main>

		<template id='area-chart'>
			<div>
				<svg :width="width" :height="height">
					<g :style="{transform: 'translate(${margin.left}px, ${margin.top}px)'}">
						<path class="area" :d="paths.area" />
						<path class="line" :d="paths.line" />
						<path class="selector" :d="paths.selector" />
					</g>
				</svg>
			</div>
		</template>

		<script src='libraries/jquery.js'></script>
		<script src='libraries/lodash.js'></script>
		<script src='libraries/d3.js'></script>
		<script src='libraries/vue.js'></script>
		<script src='resources/capital_graph.js'></script>
		<script src='resources/capital_helpers.js'></script>
		<script src='resources/capital_human.js'></script>
		<script src='resources/capital_society.js'></script>
		<script src='resources/capital.js'></script>
	</body>
</html>
